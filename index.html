<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Primăria Capitalei — Evidență Service-uri</title>
<link rel="icon" href="logo.png" type="image/png">
<style>
:root{
  --bg:#0b1622;
  --accent:#4cc2ff;
  --card-bg: rgba(255,255,255,0.05);
  --modal-bg:#f3f6f8;
  --modal-text:#222;
  --muted:#cfeeff;
  --danger:#ff6b6b;
  --btn-gray:#2c3948;
}
*{box-sizing:border-box}
body{
  font-family: Inter, Arial, sans-serif;
  background:var(--bg);
  color:#fff;
  margin:0;
}
.header{display:flex;align-items:center;gap:18px;padding:22px 28px}
.header img{width:64px;height:64px;object-fit:cover;border-radius:8px}
.header-text h2{margin:0;font-size:13px;color:var(--accent);text-transform:uppercase;letter-spacing:2px}
.header-text h1{margin:4px 0 0;font-size:20px;color:#fff}
.controls{max-width:1100px;margin:12px auto;padding:12px 20px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.controls input[type="search"]{flex:1 1 260px;padding:10px;border-radius:8px;border:0;background:#07111a;color:#cfeeff}
.controls button{background:var(--accent);color:#042231;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
.container{max-width:1100px;margin:12px auto;padding:0 20px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px;margin-top:14px}
.card{position:relative;background:var(--card-bg);border-radius:12px;overflow:hidden;padding:12px;box-shadow:0 8px 22px rgba(0,0,0,0.6);display:flex;flex-direction:column;gap:8px}
.thumb{width:100%;height:160px;border-radius:8px;background:#07111a;background-size:cover;background-position:center;box-shadow:inset 0 0 0 1px rgba(255,255,255,0.02)}
.card h3{margin:0;font-size:18px;color:#fff}
.meta{font-size:13px;color:#d6d6d6}
.actions{display:flex;gap:8px;margin-top:8px}
.btn{background:var(--accent);border:0;padding:8px 10px;border-radius:8px;color:#042231;cursor:pointer;transition:0.2s}
.btn.gray{background:var(--btn-gray);color:#fff;}
.btn.gray:hover{background:#3c4a5c;}
.btn.danger{background:var(--danger);color:#111}
.modal{display:none;position:fixed;inset:0;z-index:1400;background:rgba(0,0,0,0.7);justify-content:center;align-items:center;padding:20px;overflow:auto}
.modal.show{display:flex}
.modal-content{background:var(--modal-bg);color:var(--modal-text);width:100%;max-width:920px;border-radius:12px;padding:18px;box-shadow:0 18px 50px rgba(0,0,0,0.5);position:relative}
.modal-content h2{margin:0 0 12px;color:#0b3f61}
.close{position:absolute;right:12px;top:8px;font-size:22px;background:transparent;border:0;cursor:pointer}
.form-row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px}
.form-row .col{flex:1 1 220px}
label{display:block;font-size:13px;color:#555;margin-bottom:6px}
input[type="text"], input[type="tel"], input[type="date"], input[type="number"], textarea, select{
  width:100%;padding:10px;border-radius:8px;border:1px solid #d6dbe0;background:#fff;font-size:14px;color:#222;
}
textarea{min-height:90px;resize:vertical}
@media(max-width:720px){
  .controls{padding:8px}
  .header{padding:12px}
  .header-text h1{font-size:18px}
  .grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<div class="header">
  <img src="logo.png" alt="Logo Primaria" />
  <div class="header-text">
    <h2>PRIMĂRIA CAPITALEI</h2>
    <h1>Evidență Service-uri</h1>
  </div>
</div>

<div class="controls">
  <input id="search" type="search" placeholder="Caută..." />
  <button id="btnAdd" class="btn">Adaugă înregistrare</button>
</div>

<div class="container">
  <div class="grid" id="grid"></div>
</div>

<div id="modal" class="modal">
  <div class="modal-content">
    <button class="close" id="closeModal">&times;</button>
    <h2 id="modalTitle">Adaugă înregistrare</h2>
    <div id="form">
      <div class="form-row">
        <div class="col"><label>Nume servis</label><input id="servisName" type="text"></div>
        <div class="col"><label>Locație</label><input id="location" type="text"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Valabilitate</label><input id="validitate" type="date"></div>
        <div class="col"><label>Disponibilitate</label>
          <select id="disponibil"><option>Disponibil</option><option>Indisponibil</option></select>
        </div>
      </div>
      <div class="form-row">
        <div class="col"><label>Nume & Prenume proprietar</label><input id="ownerFull" type="text"></div>
        <div class="col"><label>CNP proprietar</label><input id="ownerCnp" type="tel" maxlength="13"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Nr. telefon proprietar</label><input id="ownerPhone" type="text"></div>
        <div class="col"><label>Nr. telefon manager</label><input id="managerPhone" type="text"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>CNP manager</label><input id="managerCnp" type="tel" maxlength="13"></div>
        <div class="col"><label>Valabilitate chirie</label><input id="validitateChirie" type="date"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Valoare penalizare</label><input id="penalizare" type="number" step="0.01"></div>
        <div class="col"><label>Amenzi</label><input id="amenzi" type="text"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Mențiuni</label><textarea id="mentiuni"></textarea></div>
        <div class="col"><label>Control medici</label>
          <select id="controlMedici"><option value="nu">Nu</option><option value="da">Da</option></select>
          <label>Control poliție</label>
          <select id="controlPolitiei"><option value="nu">Nu</option><option value="da">Da</option></select>
        </div>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button id="save" class="btn">Salvează</button>
        <button id="cancel" class="btn gray">Anulează</button>
      </div>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBOjAkRl0gzmg6xolG33VmfIpMTskoaIAs",
  authDomain: "primarie-ac04b.firebaseapp.com",
  databaseURL: "https://primarie-ac04b-default-rtdb.firebaseio.com",
  projectId: "primarie-ac04b",
  storageBucket: "primarie-ac04b.firebasestorage.app",
  messagingSenderId: "1074950947277",
  appId: "1:1074950947277:web:6741a815dd21a2e79b8484",
  measurementId: "G-7LGF8J9QJ3"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const servisRef = ref(db, 'servisuri');

const grid = document.getElementById('grid');
const btnAdd = document.getElementById('btnAdd');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const saveBtn = document.getElementById('save');
const cancelBtn = document.getElementById('cancel');
const search = document.getElementById('search');

const servisName = document.getElementById('servisName');
const locationInput = document.getElementById('location');
const validitate = document.getElementById('validitate');
const ownerFull = document.getElementById('ownerFull');
const ownerCnp = document.getElementById('ownerCnp');
const ownerPhone = document.getElementById('ownerPhone');
const managerPhone = document.getElementById('managerPhone');
const managerCnp = document.getElementById('managerCnp');
const validitateChirie = document.getElementById('validitateChirie');
const penalizare = document.getElementById('penalizare');
const amenzi = document.getElementById('amenzi');
const mentiuni = document.getElementById('mentiuni');
const controlMedici = document.getElementById('controlMedici');
const controlPolitiei = document.getElementById('controlPolitiei');
const disponibilSelect = document.getElementById('disponibil');

let editKey = null;

btnAdd.onclick = () => { editKey=null; openModal(); };
closeModal.onclick = cancelBtn.onclick = () => modal.classList.remove('show');
function openModal(){ modal.classList.add('show'); }
function getFormData(){
  return {
    name: servisName.value.trim(),
    location: locationInput.value.trim(),
    validitate: validitate.value,
    disponibil: disponibilSelect.value,
    ownerFull: ownerFull.value.trim(),
    ownerCnp: ownerCnp.value.trim(),
    ownerPhone: ownerPhone.value.trim(),
    managerPhone: managerPhone.value.trim(),
    managerCnp: managerCnp.value.trim(),
    validitateChirie: validitateChirie.value,
    penalizare: penalizare.value,
    amenzi: amenzi.value,
    mentiuni: mentiuni.value,
    controlMedici: controlMedici.value,
    controlPolitiei: controlPolitiei.value
  };
}
saveBtn.onclick = () => {
  const data = getFormData();
  if(!data.name){ alert("Completează numele"); return; }
  if(editKey){
    set(ref(db, 'servisuri/' + editKey), data);
  } else {
    push(servisRef, data);
  }
  modal.classList.remove('show');
};

function renderItem(key, data){
  const card = document.createElement('div'); card.className='card';
  const thumb = document.createElement('div'); thumb.className='thumb'; thumb.style.backgroundImage='url(logo.png)';
  const h3 = document.createElement('h3'); h3.textContent=data.name;
  const meta = document.createElement('div'); meta.className='meta';
  meta.innerHTML = `<strong>Locație:</strong> ${data.location||'-'}<br>
                    <strong>Proprietar:</strong> ${data.ownerFull||'-'} (${data.ownerCnp||'-'})<br>
                    <strong>Disponibil:</strong> ${data.disponibil||'-'}<br>
                    <strong>Manager:</strong> ${data.managerPhone||'-'}<br>
                    <strong>Control Medici:</strong> ${data.controlMedici||'-'} • <strong>Poliție:</strong> ${data.controlPolitiei||'-'}`;
  const actions = document.createElement('div'); actions.className='actions';
  const editBtn = document.createElement('button'); editBtn.className='btn gray'; editBtn.textContent='Editează';
  editBtn.onclick=()=>{ editKey=key; for(const k in data) document.getElementById(k)||document.getElementById(k).value=data[k]; openModal(); };
  const delBtn = document.createElement('button'); delBtn.className='btn danger'; delBtn.textContent='Șterge';
  delBtn.onclick=()=>{ if(confirm('Ștergi această înregistrare?')) remove(ref(db,'servisuri/'+key)); };
  actions.append(editBtn, delBtn);
  card.append(thumb,h3,meta,actions);
  grid.appendChild(card);
}

function renderAll(items){
  grid.innerHTML='';
  Object.entries(items||{}).forEach(([k,v])=>{
    renderItem(k,v);
  });
}

onValue(servisRef, snapshot => {
  renderAll(snapshot.val());
});
</script>
</body>
</html>
