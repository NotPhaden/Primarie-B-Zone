<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Primăria Capitalei — Evidență Service-uri</title>
  <link rel="icon" href="logo.png" type="image/png">
  <style>
    :root{
      --bg:#0b1622;
      --accent:#4cc2ff;
      --card-bg: rgba(255,255,255,0.05);
      --modal-bg:#f3f6f8;
      --modal-text:#222;
      --muted:#cfeeff;
      --danger:#ff6b6b;
      --btn-gray:#2c3948;
    }
    *{box-sizing:border-box;}
    body{
      font-family: Inter, Arial, sans-serif;
      background:var(--bg);
      color:#fff;
      margin:0;
    }
    .header{display:flex;align-items:center;gap:18px;padding:22px 28px}
    .header img{width:64px;height:64px;border-radius:8px}
    .header-text h2{margin:0;font-size:13px;color:var(--accent);text-transform:uppercase;letter-spacing:2px}
    .header-text h1{margin:4px 0 0;font-size:20px;color:#fff}
    .controls{max-width:1100px;margin:12px auto;padding:12px 20px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .controls input[type="search"]{flex:1 1 260px;padding:10px;border-radius:8px;border:0;background:#07111a;color:#cfeeff}
    .controls button{background:var(--accent);color:#042231;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
    .container{max-width:1100px;margin:12px auto;padding:0 20px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px;margin-top:14px}
    .card{position:relative;background:var(--card-bg);border-radius:12px;overflow:hidden;padding:12px;display:flex;flex-direction:column;gap:8px;box-shadow:0 8px 22px rgba(0,0,0,0.6);}
    .thumb{width:100%;height:160px;border-radius:8px;background:#07111a;background-size:cover;background-position:center;box-shadow:inset 0 0 0 1px rgba(255,255,255,0.02);}
    .card h3{margin:0;font-size:18px;color:#fff}
    .meta{font-size:13px;color:#d6d6d6}
    .tag{display:inline-block;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.03);font-size:12px;color:var(--muted)}
    .actions{display:flex;gap:8px;margin-top:8px}
    .btn{background:var(--accent);border:0;padding:8px 10px;border-radius:8px;color:#042231;cursor:pointer;transition:0.2s}
    .btn.gray{background:var(--btn-gray);color:#fff;}
    .btn.danger{background:var(--danger);color:#111}
    .modal{display:none;position:fixed;inset:0;z-index:1400;background:rgba(0,0,0,0.7);justify-content:center;align-items:center;padding:20px;overflow:auto}
    .modal.show{display:flex}
    .modal-content{background:var(--modal-bg);color:var(--modal-text);width:100%;max-width:920px;border-radius:12px;padding:18px;position:relative}
    .modal-content h2{margin:0 0 12px;color:#0b3f61}
    .close{position:absolute;right:12px;top:8px;font-size:22px;background:transparent;border:0;cursor:pointer}
    .form-row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px}
    .form-row .col{flex:1 1 220px}
    label{display:block;font-size:13px;color:#555;margin-bottom:6px}
    input[type="text"], input[type="tel"], input[type="date"], input[type="number"], textarea, select{
      width:100%;padding:10px;border-radius:8px;border:1px solid #d6dbe0;background:#fff;font-size:14px;color:#222;
    }
    textarea{min-height:90px;resize:vertical}
  </style>
</head>
<body>
<div class="header">
  <img src="logo.png" alt="Logo Primaria" />
  <div class="header-text">
    <h2>PRIMĂRIA CAPITALEI</h2>
    <h1>Evidență Service-uri</h1>
  </div>
</div>

<div class="controls">
  <input id="search" type="search" placeholder="Caută..." />
  <button id="btnAdd" class="btn">Adaugă înregistrare</button>
</div>

<div class="container">
  <div class="grid" id="grid"></div>
</div>

<div id="modal" class="modal">
  <div class="modal-content">
    <button class="close" id="closeModal">&times;</button>
    <h2 id="modalTitle">Adaugă înregistrare servis</h2>
    <div id="form">
      <div class="form-row">
        <div class="col"><label>Nume servis</label><input id="servisName" type="text"/></div>
        <div class="col"><label>Locație</label><input id="location" type="text"/></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Valabilitate</label><input id="validitate" type="date"/></div>
        <div class="col"><label>Disponibilitate</label><select id="disponibil"><option>Disponibil</option><option>Indisponibil</option></select></div>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button id="save" class="btn">Salvează</button>
        <button id="cancel" class="btn gray">Anulează</button>
      </div>
    </div>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyBOjAkRl0gzmg6xolG33VmfIpMTskoaIAs",
  authDomain: "primarie-ac04b.firebaseapp.com",
  databaseURL: "https://primarie-ac04b-default-rtdb.firebaseio.com",
  projectId: "primarie-ac04b",
  storageBucket: "primarie-ac04b.appspot.com",
  messagingSenderId: "1074950947277",
  appId: "1:1074950947277:web:6741a815dd21a2e79b8484",
  measurementId: "G-7LGF8J9QJ3"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const grid = document.getElementById('grid');
const btnAdd = document.getElementById('btnAdd');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const saveBtn = document.getElementById('save');
const cancelBtn = document.getElementById('cancel');
const search = document.getElementById('search');

const servisName = document.getElementById('servisName');
const locationInput = document.getElementById('location');
const validitate = document.getElementById('validitate');
const disponibilSelect = document.getElementById('disponibil');

let editId = null;

// Open modal
btnAdd.addEventListener('click', ()=>{
  editId = null;
  servisName.value = '';
  locationInput.value = '';
  validitate.value = '';
  disponibilSelect.value = 'Disponibil';
  modal.classList.add('show');
});

// Close modal
function closeModalFn(){ modal.classList.remove('show'); }
closeModal.addEventListener('click', closeModalFn);
cancelBtn.addEventListener('click', closeModalFn);

// Save
saveBtn.addEventListener('click', ()=>{
  const name = servisName.value.trim();
  if(!name){ alert('Completează numele servisului'); return; }
  const obj = {
    name,
    location: locationInput.value,
    validitate: validitate.value,
    disponibil: disponibilSelect.value,
    createdAt: Date.now()
  };
  const key = editId || db.ref('servisuri').push().key;
  db.ref('servisuri/'+key).set(obj, err=>{
    if(err){ alert('Eroare la salvare'); console.error(err); }
    else{ closeModalFn(); }
  });
});

// Render
function renderAll(snapshot){
  const data = snapshot.val() || {};
  grid.innerHTML = '';
  Object.entries(data).sort((a,b)=> b[1].createdAt - a[1].createdAt).forEach(([id,item])=>{
    const card = document.createElement('div');
    card.className='card';
    card.innerHTML = `
      <div class="thumb"></div>
      <h3>${item.name}</h3>
      <div class="meta">
        <strong>Locație:</strong> ${item.location || '—'}<br>
        <strong>Valabilitate:</strong> ${item.validitate || '—'}<br>
        <strong>Disponibil:</strong> ${item.disponibil || '—'}
      </div>
      <div class="actions">
        <button class="btn gray">Editează</button>
        <button class="btn danger">Șterge</button>
      </div>
    `;
    card.querySelector('.thumb').style.background = '#07111a';
    const [editBtn, delBtn] = card.querySelectorAll('button');
    editBtn.addEventListener('click', ()=>{
      editId = id;
      servisName.value = item.name;
      locationInput.value = item.location;
      validitate.value = item.validitate;
      disponibilSelect.value = item.disponibil;
      modal.classList.add('show');
    });
    delBtn.addEventListener('click', ()=>{ if(confirm('Ștergi înregistrarea?')) db.ref('servisuri/'+id).remove(); });
    grid.appendChild(card);
  });
}

// Listen Firebase changes
db.ref('servisuri').on('value', renderAll);

// Search
search.addEventListener('input', ()=>{
  const q = search.value.toLowerCase();
  document.querySelectorAll('.card').forEach(card=>{
    const text = card.querySelector('h3').innerText.toLowerCase();
    card.style.display = text.includes(q)?'flex':'none';
  });
});
</script>
</body>
</html>
