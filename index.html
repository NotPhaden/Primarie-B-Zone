<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Primăria Capitalei — Evidență Service-uri</title>
<link rel="icon" href="logo.png" type="image/png">
<style>
/* Aici pune CSS-ul tău exact cum l-ai avut mai sus */
</style>
</head>
<body>

<div class="header">
  <img src="logo.png" alt="Logo Primaria" />
  <div class="header-text">
    <h2>PRIMĂRIA CAPITALEI</h2>
    <h1>Evidență Service-uri</h1>
  </div>
</div>

<div class="controls">
  <input id="search" type="search" placeholder="Caută..." />
  <button id="btnAdd" class="btn">Adaugă înregistrare</button>
</div>

<div class="container">
  <div class="grid" id="grid"></div>
  <div class="note">Datele se salvează în Firebase și se văd instant de toți utilizatorii.</div>
</div>

<!-- Modal -->
<div id="modal" class="modal">
  <div class="modal-content">
    <button class="close" id="closeModal">&times;</button>
    <h2 id="modalTitle">Adaugă înregistrare</h2>
    <div id="form">
      <!-- Aici pui toate inputurile tale cum le-ai avut mai sus -->
      <div class="form-row">
        <div class="col"><label>Nume servis</label><input id="servisName" type="text"></div>
        <div class="col"><label>Locație</label><input id="location" type="text"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Valabilitate</label><input id="validitate" type="date"></div>
        <div class="col"><label>Disponibilitate</label><select id="disponibil"><option value="Disponibil">Disponibil</option><option value="Indisponibil">Indisponibil</option></select></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Proprietar</label><input id="ownerFull" type="text"></div>
        <div class="col"><label>CNP proprietar</label><input id="ownerCnp" type="tel" maxlength="13"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Nr. telefon proprietar</label><input id="ownerPhone" type="text"></div>
        <div class="col"><label>Nr. telefon manager</label><input id="managerPhone" type="text"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>CNP manager</label><input id="managerCnp" type="tel" maxlength="13"></div>
        <div class="col"><label>Valabilitate chirie</label><input id="validitateChirie" type="date"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Penalizare</label><input id="penalizare" type="number" min="0" step="0.01"></div>
        <div class="col"><label>Amenzi</label><input id="amenzi" type="text"></div>
      </div>
      <div class="form-row">
        <div class="col"><label>Mențiuni</label><textarea id="mentiuni"></textarea></div>
        <div class="col"><label>Control medici</label><select id="controlMedici"><option value="nu">Nu</option><option value="da">Da</option></select>
        <label>Control poliție</label><select id="controlPolitiei"><option value="nu">Nu</option><option value="da">Da</option></select></div>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button id="save" class="btn">Salvează</button>
        <button id="cancel" class="btn gray">Anulează</button>
      </div>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

// Config Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBOjAkRl0gzmg6xolG33VmfIpMTskoaIAs",
  authDomain: "primarie-ac04b.firebaseapp.com",
  databaseURL: "https://primarie-ac04b-default-rtdb.firebaseio.com",
  projectId: "primarie-ac04b",
  storageBucket: "primarie-ac04b.firebasestorage.app",
  messagingSenderId: "1074950947277",
  appId: "1:1074950947277:web:6741a815dd21a2e79b8484",
  measurementId: "G-7LGF8J9QJ3"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const servisRef = ref(db, 'servisuri');

const grid = document.getElementById('grid');
const btnAdd = document.getElementById('btnAdd');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const saveBtn = document.getElementById('save');
const cancelBtn = document.getElementById('cancel');

const inputs = {
  servisName: document.getElementById('servisName'),
  location: document.getElementById('location'),
  validitate: document.getElementById('validitate'),
  disponibil: document.getElementById('disponibil'),
  ownerFull: document.getElementById('ownerFull'),
  ownerCnp: document.getElementById('ownerCnp'),
  ownerPhone: document.getElementById('ownerPhone'),
  managerPhone: document.getElementById('managerPhone'),
  managerCnp: document.getElementById('managerCnp'),
  validitateChirie: document.getElementById('validitateChirie'),
  penalizare: document.getElementById('penalizare'),
  amenzi: document.getElementById('amenzi'),
  mentiuni: document.getElementById('mentiuni'),
  controlMedici: document.getElementById('controlMedici'),
  controlPolitiei: document.getElementById('controlPolitiei')
};

let editKey = null;

// Open modal
btnAdd.onclick = () => {
  editKey = null;
  for(const k in inputs) inputs[k].value='';
  modal.classList.add('show');
};

// Close modal
closeModal.onclick = cancelBtn.onclick = () => modal.classList.remove('show');

// Save
saveBtn.onclick = () => {
  if(!inputs.servisName.value.trim()){ alert("Completează numele"); return; }
  const data = {};
  for(const k in inputs) data[k] = inputs[k].value;
  if(editKey){
    set(ref(db, 'servisuri/'+editKey), data);
  }else{
    push(servisRef, data);
  }
  modal.classList.remove('show');
};

// Render items live
onValue(servisRef, snapshot=>{
  grid.innerHTML='';
  snapshot.forEach(child=>{
    const key = child.key;
    const data = child.val();
    const card = document.createElement('div'); card.className='card';
    const thumb = document.createElement('div'); thumb.className='thumb'; thumb.style.backgroundImage='url(logo.png)';
    const h3 = document.createElement('h3'); h3.textContent = data.servisName;
    const meta = document.createElement('div'); meta.className='meta';
    meta.innerHTML=`<strong>Locație:</strong> ${data.location}<br>
                    <strong>Proprietar:</strong> ${data.ownerFull} (${data.ownerCnp})<br>
                    <strong>Disponibil:</strong> ${data.disponibil}<br>
                    <strong>Manager:</strong> ${data.managerPhone}<br>
                    <strong>Control Medici:</strong> ${data.controlMedici} • <strong>Poliție:</strong> ${data.controlPolitiei}`;
    const actions = document.createElement('div'); actions.className='actions';
    const editBtn = document.createElement('button'); editBtn.className='btn gray'; editBtn.textContent='Editează';
    editBtn.onclick = ()=>{
      editKey = key;
      for(const k in inputs) inputs[k].value = data[k]||'';
      modal.classList.add('show');
    };
    const delBtn = document.createElement('button'); delBtn.className='btn danger'; delBtn.textContent='Șterge';
    delBtn.onclick = ()=>{ if(confirm('Ștergi această înregistrare?')) remove(ref(db,'servisuri/'+key)); };
    actions.append(editBtn, delBtn);
    card.append(thumb, h3, meta, actions);
    grid.appendChild(card);
  });
});
</script>
</body>
</html>
